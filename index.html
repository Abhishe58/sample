<!DOCTYPE html>
<html>
<head>
  <title>Nearby Hospitals</title>
</head>
<body>
<!--   <a href="sms:+919510954023?body=Hello">Send Emergency SMS</a>
  <h2>Your Location:</h2>
  <p id="location">Getting location...</p>

  <h2>Nearby Hospitals:</h2>
  <ul id="hospitalList"></ul>

  <script>
    // Step 1: Get user location
      if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(success, error);
  } else {
    document.getElementById("location").textContent = "Geolocation not supported.";
  }

  function success(position) {
    const lat = position.coords.latitude;
    const lon = position.coords.longitude;

    // Step 2: Show lat/lon
    document.getElementById("location").textContent = `Latitude: ${lat}, Longitude: ${lon}`;

    // Step 3: Call Overpass API
    const delta = 0.02;
    const overpassUrl = `https://overpass-api.de/api/interpreter?data=[out:json];node["amenity"="hospital"](${lat - delta},${lon - delta},${lat + delta},${lon + delta});out;`;

    fetch(overpassUrl)
      .then(res => res.json())
      .then(data => {
        const hospitalList = document.getElementById("hospitalList");
        hospitalList.innerHTML = ""; // Clear previous results

        if (data.elements.length === 0) {
          hospitalList.innerHTML = "<li>No hospitals found nearby.</li>";
        } else {
          data.elements.forEach(hospital => {
            const tags = hospital.tags || {};
            const name = tags.name || "Unnamed Hospital";
            const phone = tags.phone || tags["contact:phone"] || "Phone not available";

            const li = document.createElement("li");
            li.textContent = `${name} - ${phone}`;
            hospitalList.appendChild(li);
          });
        }
      })
      .catch(err => {
        document.getElementById("hospitalList").innerHTML = "<li>Error fetching hospitals.</li>";
        console.error(err);
      });
  }

  function error(err) {
    document.getElementById("location").textContent = "Error getting location.";
    console.warn(err);
  }
  </script> -->
  <p id="location">Getting location...</p>
<ul id="hospitalList"></ul>
<button onclick="sendEmergencySMS()">Send Emergency SMS</button>
<script>
  let currentLat = null;
let currentLon = null;

function success(position) {
  currentLat = position.coords.latitude;
  currentLon = position.coords.longitude;

  document.getElementById("location").textContent = `Latitude: ${currentLat}, Longitude: ${currentLon}`;

  // Same Overpass API fetch code here...

}

// Emergency SMS Function
function sendEmergencySMS() {
  if (currentLat && currentLon) {
    const message = `Emergency! I need help.\nMy location:\nLatitude: ${currentLat}, Longitude: ${currentLon}`;
    const phoneNumber = "1234567890"; // Replace with emergency contact

    // Opens the SMS app with prefilled message
    const smsLink = `sms:${phoneNumber}?body=${encodeURIComponent(message)}`;
    window.location.href = smsLink;
  } else {
    alert("Location not available yet.");
  }
}

</script>
</body>
</html>
